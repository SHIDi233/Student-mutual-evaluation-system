(function(){var t={7292:function(){},725:function(t,e,a){"use strict";a(7658);var s=a(144),i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},n=[],o=a(7292),l=a.n(o),r=l(),d=a(1001),c=(0,d.Z)(r,i,n,!1,null,null,null),h=c.exports,u=a(8345),p=function(){var t=this,e=t._self._c;return e("body",[e("div",{staticClass:"login"},[e("div",{staticClass:"box"},[e("p",{staticClass:"table",staticStyle:{font:"900 40px ''","text-align":"center","letter-spacing":"5px",color:"#3d3d3d"}},[t._v("CCN作业互评系统")]),e("br"),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ac,expression:"ac"}],attrs:{id:"account",type:"text",placeholder:"账号",value:""},domProps:{value:t.ac},on:{input:function(e){e.target.composing||(t.ac=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pw,expression:"pw"}],attrs:{id:"pwd",type:"password",placeholder:"密码",value:""},domProps:{value:t.pw},on:{input:function(e){e.target.composing||(t.pw=e.target.value)}}}),e("br"),e("div",{staticStyle:{width:"100%"}},[e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"go",staticStyle:{width:"100%","text-align":"center",display:"block",left:"0px",height:"44px",padding:"10px",font:"900 20px ''","border-radius":"10px","margin-top":"15px",color:"#fff","letter-spacing":"3px","background-image":"linear-gradient(to left,"},on:{click:t.getValue}},[t._v("登录")])],1),e("div",[e("el-button",{staticClass:"go",staticStyle:{width:"100%","text-align":"center",display:"block",left:"0px",height:"44px",padding:"10px",font:"900 20px ''","border-radius":"10px","margin-top":"15px",color:"#fff","letter-spacing":"3px","background-image":"linear-gradient(to left,"},on:{click:t.register}},[t._v("注册")])],1)])])])},m=[],g=(a(2062),a(6154));const v="http://127.0.0.1:8888/";var f,w,b={ip:v},x=b,y=(0,d.Z)(x,f,w,!1,null,null,null),_=y.exports;const k=_.ip;var D={data(){return{ac:"",pw:"",loading:!1}},methods:{getValue:function(){this.loading=!0;var t=new URLSearchParams;t.append("mail",this.ac),t.append("password",this.pw),g.Z.post(k+"login",t).then((t=>{console.log(t.data),1==t.data.code?(window.localStorage.setItem("CCNtoken",t.data.data),this.$router.push("/home")):(this.$message.error("账户/密码错误"),this.loading=!1)})).catch((t=>{this.$message.error(+t+" (网络错误)"),this.loading=!1}))},register:function(){this.$router.push("/register")}}},I=D,S=(0,d.Z)(I,p,m,!1,null,"9d15809e",null),$=S.exports,C=function(){var t=this,e=t._self._c;return e("body",[e("div",{staticClass:"login"},[e("div",{staticClass:"box"},[e("p",{staticClass:"table"},[t._v("Git CCN")]),e("br"),e("input",{directives:[{name:"model",rawName:"v-model",value:t.mail,expression:"mail"}],attrs:{id:"mail",type:"text",placeholder:"邮箱",value:""},domProps:{value:t.mail},on:{input:function(e){e.target.composing||(t.mail=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{id:"name",type:"text",placeholder:"真实姓名",value:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"pwd",type:"password",placeholder:"密码",value:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),e("a",{staticClass:"go",attrs:{href:"#"},on:{click:t.commit}},[t._v("提交")]),e("br")])])])},Z=[];const U=_.ip;var N={data(){return{mail:"",name:"",password:""}},methods:{commit:function(){var t=this.mail,e=this.name,a=this.password,s=/^\w{3,}(\.\w+)*@[A-z0-9]+(\.[A-z]{2,5}){1,2}$/;if(""!=t)if(0!=s.test(t))if(""!=e)if(""!=a)if(a.length<5)alert("密码位数至少大于5");else{var i=new URLSearchParams;i.append("mail",this.mail),i.append("name",this.name),i.append("password",this.password),g.Z.post(U+"register",i).then((t=>{console.log(t.data),1==t.data.code?(alert("注册成功"),window.localStorage.setItem("CCNtoken",t.data.data),this.$router.push("/chg")):alert("注册失败：邮箱已被注册")})).catch((t=>{console.log(t),alert("请求失败")}))}else alert("密码不能为空");else alert("昵称不能为空");else alert("请输入正确的邮箱地址");else alert("邮箱地址不能为空")}}},R=N,P=(0,d.Z)(R,C,Z,!1,null,"76a4bb7b",null),T=P.exports,L=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-header",[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[e("el-menu-item",{attrs:{index:"1"}},[t._v("班级")]),e("el-menu-item",{attrs:{index:"3"}},[e("el-badge",{staticClass:"item",attrs:{value:t.numUnRead,hidden:0===t.numUnRead}},[t._v("消息中心")])],1),e("el-submenu",{staticStyle:{float:"right"},attrs:{index:"5"}},[e("template",{slot:"title"},[e("el-avatar",{attrs:{size:35,src:t.header_url}})],1),e("el-menu-item",{attrs:{index:"6"}},[t._v("个人中心")]),e("el-menu-item",{attrs:{index:"7"}},[t._v("修改信息")]),e("el-menu-item",{attrs:{index:"8"}},[t._v("注销")])],2),e("el-menu-item",{directives:[{name:"loading",rawName:"v-loading",value:""===this.name,expression:"this.name===''"}],staticStyle:{float:"right","font-weight":"bold"}},[t._v("你好，"+t._s(this.name)+"，欢迎使用CCN互评系统👋")])],1)],1),e("el-container",[e("el-aside",{attrs:{width:"200px"}}),e("el-main",[e("router-view")],1)],1)],1)],1)},M=[];const H=_.ip;var z={data(){return{activeIndex:"0",activeIndex2:"3",fits:["contain"],header_url:"",name:"",numUnRead:0}},created(){g.Z.post(H+"header").then((t=>{this.header_url=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(H+"info").then((t=>{this.name=t.data.data.name})).catch((function(t){console.log(t)})),g.Z.post(H+"getUnread").then((t=>{this.numUnRead=t.data.data})).catch((function(t){console.log(t)}))},methods:{handleSelect(t,e){console.log(t,e),3==t&&this.$router.push("/msg"),6==t&&this.$router.push("/self"),7==t&&this.$router.push("/chg"),8==t&&(localStorage.removeItem("CCNtoken"),this.$router.push("../../login")),1==t&&(console.log(t,e),this.$router.push("/class")),2==t&&this.$router.push("/hw")},closeID(){localStorage.removeItem("CCNtoken"),this.$router.push("../../login")}}},A=z,O=(0,d.Z)(A,L,M,!1,null,null,null),j=O.exports,W=function(){var t=this,e=t._self._c;return e("div",[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":t.tableRowClassName,data:t.tableData,"max-height":"8 50","default-sort":{prop:"noteID",order:"descending"}}},[e("el-table-column",{attrs:{fixed:"",prop:"type",label:"类型",width:"150"}}),e("el-table-column",{attrs:{fixed:"",prop:"time",label:"日期",width:"250"}}),e("el-table-column",{attrs:{fixed:"",prop:"noteID",label:"单号",width:"170"}}),e("el-table-column",{attrs:{prop:"scope",label:"范围",width:"100"}}),e("el-table-column",{attrs:{prop:"content",label:"简介",width:"320"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.startRow(a.$index,a.row)}}},[t._v(" 查看详细 ")])]}}])})],1),e("el-drawer",{attrs:{title:"详细",visible:t.drawer,direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[e("div",{staticStyle:{"margin-left":"20px"}},["NT"!=t.type?e("span",[t._v("由此来审批!"),e("br")]):t._e(),e("el-divider"),t._v(" "+t._s(""==this.data?"loading...":this.data)+" ")],1),e("el-divider"),e("div",{staticStyle:{"margin-left":"50px"}},["CA-yes"==t.type?e("span",[t._v("已同意!"),e("br")]):t._e(),"CA-no"==t.type?e("span",[t._v("已拒绝!"),e("br")]):t._e()]),"NT"!=t.type&&"CA-yes"!=t.type&&"CA-no"!=t.type?e("div",{staticStyle:{"margin-left":"50px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Click_2()}}},[t._v("拒绝")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Click()}}},[t._v("同意")])],1):t._e()],1)],1)},F=[];const E=_.ip;var V={methods:{Click(){this.bc=!0;var t=new URLSearchParams;t.append("noteID",this.noteID),t.append("grant","1"),t.append("type",this.type),g.Z.post(E+"classApprove",t).then((t=>{"success"==t.data.msg?(this.$message({message:"审批通过",type:"success"}),this.drawer=!1,this.input_code=""):this.$message.error("失败")})).catch((function(t){console.log(t)}))},Click_2(){this.bc=!0;var t=new URLSearchParams;t.append("noteID",this.noteID),t.append("grant","-1"),t.append("type",this.type),g.Z.post(E+"classApprove",t).then((t=>{"success"==t.data.msg?(this.$message({message:"审批拒绝",type:"success"}),this.drawer_2=!1,this.input_code=""):this.$message.error("失败")})).catch((function(t){console.log(t)}))},startRow(t,e){console.log(t,e),this.nid=e.noteID,this.noteID=e.noteID,console.log(e.type),this.type=e.type,this.drawer=!0;var a=new URLSearchParams;a.append("nID",this.noteID),g.Z.post(E+"readNotation",a).then((t=>{"success"==t.data.msg?this.data=t.data.data:this.$message.error("网络错误")})).catch((function(t){console.log(t)}))},tableRowClassName({row:t,rowIndex:e}){return!1===this.tableData[e].isRead?"warning-row":""}},data(){return{loading:!0,tableData:[],drawer:!1,nid:"",data:""}},created(){g.Z.get(E+"Notations").then((t=>{this.loading=!1,this.tableData=t.data.data})).catch((function(t){console.log(t)}))}},B=V,X=(0,d.Z)(B,W,F,!1,null,null,null),q=X.exports,Y=function(){var t=this,e=t._self._c;return e("div",[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"头像"}},[t.header_url?e("el-image",{staticStyle:{width:"178px",height:"178px"},attrs:{lazy:"",src:t.header_url,fit:t.fit}}):t._e(),e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadurl,"show-file-list":!1,headers:{token:this.token},"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?e("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e("el-form-item",{attrs:{label:"学校"}},[e("el-select",{attrs:{placeholder:"请选择",disabled:t.isWrite_2},model:{value:t.form.school,callback:function(e){t.$set(t.form,"school",e)},expression:"form.school"}},[e("el-option",{attrs:{label:"北京交通大学",value:"北京交通大学"}}),e("el-option",{attrs:{label:"其他学校",value:"other"}})],1)],1),e("el-form-item",{attrs:{label:"学号"}},[e("el-input",{attrs:{disabled:t.isWrite},model:{value:t.form.studentID,callback:function(e){t.$set(t.form,"studentID",e)},expression:"form.studentID"}})],1),e("el-form-item",{attrs:{label:"专业"}},[e("el-input",{attrs:{disabled:t.isWrite_3},model:{value:t.form.majority,callback:function(e){t.$set(t.form,"majority",e)},expression:"form.majority"}})],1),e("el-form-item",{attrs:{label:"个人介绍"}},[e("el-input",{model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交修改")])],1)],1)],1)},G=[];const K=_.ip;var J={data(){return{header_url:"",uploadurl:K+"uploadHeader",form:{name:"",school:"",majority:"",introduction:"",studentID:""},isWrite:!1,token:localStorage.getItem("CCNtoken")}},created(){g.Z.post(K+"header").then((t=>{this.header_url=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(K+"info").then((t=>{this.form.name=t.data.data.name,this.form.introduction=t.data.data.introduction,this.form.school=t.data.data.school,this.form.majority=t.data.data.majority,this.form.studentID=t.data.data.studentID,null!=this.form.studentID&&(this.form.studentID=this.form.studentID+"(已认证)",this.isWrite=!0,this.isWrite_2=!0,this.isWrite_3=!0)})).catch((function(t){console.log(t)}))},methods:{onSubmit(){console.log("submit!");var t=new URLSearchParams;t.append("school",this.form.school),t.append("majority",this.form.majority),t.append("introduction",this.form.introduction),t.append("studentID",this.form.studentID),g.Z.post(K+"modify",t).then((t=>{console.log(t.data),1==t.data.code?"success"==t.data.msg?this.$message({message:"修改成功",type:"success"}):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))},handleAvatarSuccess(t,e){this.imageUrl=URL.createObjectURL(e.raw)},beforeAvatarUpload(t){const e=t.size/1024/1024<12;return e||this.$message.error("上传头像图片大小不能超过 12MB!"),e}}},Q=J,tt=(0,d.Z)(Q,Y,G,!1,null,null,null),et=tt.exports,at=function(){var t=this,e=t._self._c;return e("div",[e("el-container",[e("el-aside",{attrs:{width:"300px"}},[e("div",[e("el-avatar",{attrs:{size:160,src:t.circleUrl}})],1),e("div",[e("el-descriptions",{attrs:{title:t.title,colon:!1,column:1}},[e("el-descriptions-item",{attrs:{label:t.school}}),e("el-descriptions-item",{attrs:{label:t.label}})],1)],1)]),e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("div",[e("el-button-group",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isEdit=!0}}},[t._v("编辑")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isEdit=!1}}},[t._v("预览")]),e("el-button",{attrs:{type:"primary"},on:{click:t.upload}},[t._v("保存")])],1)],1),t.isEdit?e("div",[e("mavon-editor",{ref:"md",on:{imgAdd:t.$imgAdd},model:{value:t.markdown,callback:function(e){t.markdown=e},expression:"markdown"}})],1):e("div",{domProps:{innerHTML:t._s(t.html)}})])],1)],1)},st=[],it=a(7441);const nt=_.ip;var ot={data(){return{isEdit:!1,title:"CCN_default_name",label:"",circleUrl:"",context:"111",school:"",loading:!0,markdown:"# loading...",html:"",flag:""}},methods:{$imgAdd(t,e){let a=this.$refs.md;var s=new FormData;s.append("file",e),console.log(e),(0,g.Z)({url:nt+"uploadFile",method:"post",data:s}).then((e=>{a.$img2Url(t,e.data.data)}))},upload(){var t=new URLSearchParams;t.append("readme",this.markdown),g.Z.post(nt+"uploadReadme",t).then((t=>{"success"==t.data.msg?this.$message({message:"修改成功",type:"success"}):this.$message.error("修改失败")})).catch((function(t){console.log(t)}))}},created(){g.Z.post(nt+"header").then((t=>{this.circleUrl=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(nt+"info").then((t=>{this.title=t.data.data.name,this.label=t.data.data.introduction,this.context=t.data.data.readme,this.school=t.data.data.school+"/"+t.data.data.majority})).catch((function(t){console.log(t)}))},computed:{compiledMarkdown(){return it.TU.parse(this.context)}},watch:{compiledMarkdown(){this.loading=!1,this.markdown=this.context,this.html=it.TU.parse(this.context)},markdown(t){this.html=(0,it.TU)(t)}}},lt=ot,rt=(0,d.Z)(lt,at,st,!1,null,null,null),dt=rt.exports,ct=function(){var t=this,e=t._self._c;return e("div",[e("router-view"),e("div",[e("el-button",{staticStyle:{float:"right","margin-left":"10px","margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(e){t.drawer_2=!0}}},[t._v("加入班级")]),t.b?t._e():e("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{loading:t.loading,disabled:t.b},on:{click:function(e){t.drawer=!0}}},[t._v("新建班级")])],1),e("div",{staticStyle:{"margin-top":"10px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.lodingTable,expression:"lodingTable"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"classID",label:"班级编号",width:"120"}}),e("el-table-column",{attrs:{prop:"className",label:"名称",width:"120"}}),e("el-table-column",{attrs:{prop:"introduction",label:"简介",width:"120"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleClick(a.row)}}},[t._v("查看")]),[e("el-popconfirm",{staticStyle:{"margin-left":"18px"},attrs:{title:"确定删除班级吗"},on:{confirm:function(e){return t.handleDelete(a.row)}}},[e("el-button",{attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[t._v("删除")])],1)]]}}])})],1)],1),e("el-drawer",{attrs:{title:"创建页",visible:t.drawer,direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[e("span",{staticStyle:{"margin-left":"20px"}},[t._v("由此来创建一个新的班级!")]),e("el-divider"),e("div",{staticStyle:{"margin-left":"20px","margin-right":"20px"}},[e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"请输入班级名称",clearable:""},model:{value:t.input_name,callback:function(e){t.input_name=e},expression:"input_name"}}),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"请输入学科",clearable:""},model:{value:t.input_sub,callback:function(e){t.input_sub=e},expression:"input_sub"}}),e("el-input",{staticStyle:{"margin-top":"10px"},attrs:{type:"textarea",rows:2,placeholder:"请输入课程简介"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1),e("el-button",{staticStyle:{float:"right","margin-right":"20px","margin-top":"10px"},attrs:{type:"primary",loading:t.bc},on:{click:function(e){return t.Click()}}},[t._v("创建")])],1),e("el-drawer",{attrs:{title:"加入页",visible:t.drawer_2,direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer_2=e}}},[e("span",{staticStyle:{"margin-left":"20px"}},[t._v("由此来加入一个新的班级!")]),e("div",{staticStyle:{"margin-left":"20px","margin-top":"10px"}},[e("el-input",{attrs:{placeholder:"请输入班级代码",clearable:""},on:{input:t.handlerChange},model:{value:t.input_code,callback:function(e){t.input_code=e},expression:"input_code"}}),e("el-divider"),e("el-descriptions",{attrs:{title:t.className,colon:!1,column:1}},[e("el-descriptions-item",{attrs:{label:t.classID}}),e("el-descriptions-item",{attrs:{label:t.subject}}),e("el-descriptions-item",{attrs:{label:t.introduction}})],1),e("el-divider")],1),e("el-button",{staticStyle:{float:"right","margin-right":"20px","margin-top":"10px"},attrs:{type:"primary",loading:t.bc_2,disabled:t.b_2},on:{click:function(e){return t.Click_2()}}},[t._v("加入")])],1)],1)},ht=[];const ut=_.ip;var pt={methods:{handleClick(t){console.log(t),this.$router.push("class/"+t.classID)},handleDelete(t){console.log(t);var e=new URLSearchParams;e.append("classID",t.classID),g.Z.post(ut+"deleteClass",e).then((t=>{this.bc=!1,"success"==t.data.msg?(this.$message({message:"删除成功",type:"success"}),g.Z.get(ut+"getClasses").then((t=>{this.tableData=t.data.data})).catch((function(t){console.log(t)}))):this.$message.error("删除失败")}))},Click(){this.bc=!0;var t=new URLSearchParams;t.append("className",this.input_name),t.append("introduction",this.textarea),t.append("subject",this.input_sub),g.Z.post(ut+"createClass",t).then((t=>{this.bc=!1,"success"==t.data.msg?(this.$message({message:"创建成功",type:"success"}),this.drawer=!1,g.Z.get(ut+"getClasses").then((t=>{this.tableData=t.data.data})).catch((function(t){console.log(t)}))):this.$message.error("创建失败")})).catch((function(t){console.log(t)}))},handlerChange(t){this.bc_2=!0,this.b_2=!0,console.log(t);var e=new URLSearchParams;e.append("code",this.input_code),g.Z.post(ut+"searchClass",e).then((t=>{"success"==t.data.msg?(this.classID=t.data.data.classID,this.className="班级名称："+t.data.data.className,this.subject="课程名字："+t.data.data.subject,this.introduction="课程简介："+t.data.data.introduction,this.b_2=!1,this.bc_2=!1):(this.bc_2=!1,this.classID="",this.className="",this.subject="",this.introduction="")})).catch((function(t){console.log(t)}))},Click_2(){this.bc=!0;var t=new URLSearchParams;t.append("classID",this.classID),g.Z.post(ut+"joinClass",t).then((t=>{"success"==t.data.msg?(this.$message({message:"加入班级"+this.className+"成功",type:"success"}),this.drawer_2=!1,this.input_code=""):this.$message.error("创建失败")})).catch((function(t){console.log(t)}))}},created(){g.Z.get(ut+"isTeacher").then((t=>{this.b=t.data,this.b=!this.b,this.loading=!1})).catch((function(t){console.log(t)})),g.Z.get(ut+"getClasses").then((t=>{this.tableData=t.data.data,this.lodingTable=!1})).catch((function(t){console.log(t)}))},data(){return{drawer:!1,drawer_2:!1,direction:"rtl",tableData:[],loading:!0,b:!1,input_name:"",input_sub:"",textarea:"",bc:!1,input_code:"",b_2:!0,bc_2:!1,classID:"",className:"",subject:"",introduction:"",classdata:[],lodingTable:!0}}},mt=pt,gt=(0,d.Z)(mt,ct,ht,!1,null,null,null),vt=gt.exports,ft=function(){var t=this,e=t._self._c;return e("div",[e("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"filename",id:"open"},on:{change:t.changeFile}}),e("el-page-header",{staticStyle:{"margin-bottom":"20px"},attrs:{content:t.ct},on:{back:t.goBack}}),e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"班级成员",name:"first"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":"8 50"}},[e("el-table-column",{attrs:{fixed:"",prop:"role",label:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1===e.row.role?"老师":"学生")+" ")]}}])}),e("el-table-column",{attrs:{fixed:"",prop:"header",label:"",width:"70"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{staticClass:"head_pic",attrs:{src:t.row.header,width:"40",height:"40"}})]}}])}),e("el-table-column",{attrs:{fixed:"",prop:"studentID",label:"学号",width:"250"}}),e("el-table-column",{attrs:{fixed:"",prop:"name",label:"姓名",width:"370"}}),e("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.startRow(a.$index,a.row)}}},[t._v(" 查看详细 ")]),[e("el-popconfirm",{attrs:{title:"确认删除同学吗"},on:{confirm:function(e){return t.deleteRow(a.$index,a.row)}}},[e("el-button",{staticStyle:{"margin-left":"15px"},attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[t._v(" 删除 ")])],1)]]}}])})],1),e("el-button",{staticStyle:{"margin-right":"30px","margin-top":"10px",float:"right"},on:{click:function(e){return t.upXls()}}},[t._v("一键导入同学")])],1),e("el-tab-pane",{attrs:{label:"作业",name:"second"}},[e("div",[0==!this.role?e("el-button",{attrs:{type:"primary",loading:t.loading,disabled:0==this.role},on:{click:function(e){return t.publish()}}},[t._v("新建作业")]):t._e(),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.data,"default-sort":{prop:"hwID",order:"descending"},border:""}},[e("el-table-column",{attrs:{prop:"hwID",label:"作业编号",width:"120"}}),e("el-table-column",{attrs:{prop:"name",label:"作业名称",width:"120"}}),e("el-table-column",{attrs:{prop:"ddl",label:"截止时间",width:"120"}}),1===this.role?e("el-table-column",{attrs:{prop:"isPublish",label:"是否发布",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.isPublish?"已发布":"待发布"))])]}}],null,!1,3186481879)}):t._e(),0===this.role?e("el-table-column",{attrs:{prop:"isSubmit",label:"是否提交",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.isSubmit?"已提交":"待提交"))])]}}],null,!1,3534869978)}):t._e(),e("el-table-column",{attrs:{prop:"cTime",label:"创建时间",width:"120"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleClick(a.row)}}},[t._v("查看")]),a.row.isSubmit&&0==t.role?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleClick_2(a.row)}}},[t._v("开始互评")]):t._e()]}}])})],1)],1)])],1),e("el-dialog",{attrs:{title:"控制台输出",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(this.console))]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1,t.refresh()}}},[t._v("O K")])],1)])],1)},wt=[];const bt=_.ip;var xt={methods:{publish(){g.Z.get(bt+"createHomework").then((t=>{let e=this.$router.resolve({path:`/hw/publish/${t.data.data}/${this.classID}`});window.open(e.href,"_blank")}))},handleClick(t){if(1==this.role){let e=this.$router.resolve({path:`/hw/publish/${t.hwID}/${this.classID}`});window.open(e.href,"_blank")}else if(0==this.role)if(t.isSubmit){let e=this.$router.resolve({path:`/hw/watch/${t.hwID}`});window.open(e.href,"_blank")}else{let e=this.$router.resolve({path:`/hw/write/${t.hwID}`});window.open(e.href,"_blank")}},handleClick_2(t){let e=this.$router.resolve({path:`/hw/evaluate/${t.hwID}`});window.open(e.href,"_blank")},goBack(){console.log("go back"),this.$router.push("../class")},startRow(t,e){console.log(t,e),alert("该功能暂时不可用")},deleteRow(t,e){var a=new URLSearchParams;a.append("classID",this.$route.params.classID),a.append("uID",e.uID),g.Z.post(bt+"kickMember",a).then((t=>{if("success"==t.data.msg){this.$message({message:"踢出"+e.name+"成功",type:"success"});var a=new URLSearchParams;a.append("classID",this.$route.params.classID),g.Z.post(bt+"listMember",a).then((t=>{this.tableData=t.data.data,this.loading=!1})).catch((function(t){console.log(t)}))}else this.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},upXls(){document.getElementById("open").click()},changeFile(){const t=document.getElementById("open");if(null!=t){this.upload=!0,console.log(t.files[0]);var e=new FormData;e.append("file",t.files[0]),(0,g.Z)({url:bt+"uploadXls",method:"post",data:e,headers:{cID:this.$route.params.classID}}).then((async t=>{this.dialogVisible=!0;for(let e=0;e<t.data.data.length;e++)this.console+="> "+t.data.data[e]+"\n",await new Promise((t=>setTimeout(t,200)));this.console+="> done."}))}},refresh(){g.Z.get(bt+"getRole").then((t=>{this.role=t.data.data;var e=new URLSearchParams;e.append("cID",this.$route.params.classID),0==t.data.data?g.Z.post(bt+"getHomework",e).then((t=>{for(let e=0;e<t.data.data.length;e++)this.data.push(t.data.data[e])})).catch((function(t){console.log(t)})):1==t.data.data&&g.Z.post(bt+"listHomework",e).then((t=>{for(let e=0;e<t.data.data.length;e++)console.log(t.data.data[e].cID),t.data.data[e].cID==this.$route.params.classID&&(this.data.push(t.data.data[e]),console.log(this.data))})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)})),g.Z.get(bt+"getClasses").then((t=>{1==t.data.code?"success"==t.data.msg?this.options=t.data.data:this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}));var t=new URLSearchParams;t.append("classID",this.$route.params.classID),g.Z.post(bt+"listMember",t).then((t=>{this.tableData=t.data.data,this.loading=!1})).catch((function(t){console.log(t)})),g.Z.get(bt+`getCode?classID=${this.$route.params.classID}`).then((t=>{this.ct=t.data.data.className+" 代码("+t.data.data.code+")"})).catch((function(t){console.log(t)}))}},data(){return{classID:this.$route.params.classID,loading:!0,tableData:[],drawer:!1,nid:"",ct:"",cd:"",data:[],role:-1,classes:[],options:[],dialogVisible:!1,console:""}},created(){g.Z.get(bt+"getRole").then((t=>{this.role=t.data.data;var e=new URLSearchParams;e.append("cID",this.$route.params.classID),0==t.data.data?g.Z.post(bt+"getHomework",e).then((t=>{for(let e=0;e<t.data.data.length;e++)this.data.push(t.data.data[e])})).catch((function(t){console.log(t)})):1==t.data.data&&g.Z.post(bt+"listHomework",e).then((t=>{for(let e=0;e<t.data.data.length;e++)console.log(t.data.data[e].cID),t.data.data[e].cID==this.$route.params.classID&&(this.data.push(t.data.data[e]),console.log(this.data))})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)})),g.Z.get(bt+"getClasses").then((t=>{1==t.data.code?"success"==t.data.msg?this.options=t.data.data:this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}));var t=new URLSearchParams;t.append("classID",this.$route.params.classID),g.Z.post(bt+"listMember",t).then((t=>{this.tableData=t.data.data,this.loading=!1})).catch((function(t){console.log(t)})),g.Z.get(bt+`getCode?classID=${this.$route.params.classID}`).then((t=>{this.ct=t.data.data.className+" 代码("+t.data.data.code+")"})).catch((function(t){console.log(t)}))}},yt=xt,_t=(0,d.Z)(yt,ft,wt,!1,null,null,null),kt=_t.exports,Dt=function(){var t=this,e=t._self._c;return e("div",[e("el-header",[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[e("el-menu-item",{directives:[{name:"loading",rawName:"v-loading",value:""===this.name,expression:"this.name===''"}],staticStyle:{float:"right","font-weight":"bold"}},[t._v("你好，"+t._s(this.name)+"，欢迎使用CCN互评系统👋")])],1)],1),e("el-container",[e("el-aside"),e("el-main",[e("el-tabs",[e("el-tab-pane",{attrs:{label:"作业内容",name:"first"}},[e("div",{staticClass:"demo-input-suffix"},[t._v(" 作业名： "),e("el-input",{attrs:{placeholder:"作业名"},model:{value:t.hwName,callback:function(e){t.hwName=e},expression:"hwName"}})],1),e("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"filename",id:"open"},on:{change:t.changeFile}}),e("el-divider"),e("div",[t._v(" 作业内容： "),e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.upload,expression:"upload"}]},[e("div",{attrs:{id:"main"}},[e("mavon-editor",{ref:"md",attrs:{toolbars:t.markdownOption},on:{imgAdd:t.$imgAdd},model:{value:t.hwContent,callback:function(e){t.hwContent=e},expression:"hwContent"}},[e("template",{slot:"left-toolbar-after"},[e("button",{staticClass:"op-icon el-icon-paperclip",attrs:{type:"button","aria-hidden":"true",title:"上传附件"},on:{click:t.$fileAdd}})])],2)],1)])],1),e("div",{staticStyle:{float:"right"}},[e("el-button",{on:{click:t.save}},[t._v("暂存")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.drawer=!0}}},[t._v("下一步")])],1),e("el-drawer",{attrs:{title:"设置分数与截止时间",visible:t.drawer,direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[e("div",{staticStyle:{"margin-left":"20px","margin-right":"20px"}},[e("span",{staticClass:"demonstration"},[t._v("设置分数")]),e("el-input",{staticStyle:{"margin-top":"10px"},model:{value:t.score,callback:function(e){t.score=e},expression:"score"}})],1),e("el-divider"),e("div",{staticStyle:{"margin-left":"20px","margin-right":"20px"}},[e("div",[e("span",{staticClass:"demonstration"},[t._v("设置截止时间")])]),e("el-date-picker",{staticStyle:{"margin-top":"10px"},attrs:{type:"datetime",placeholder:"选择日期时间","default-time":"00:00:00","value-format":"yyyy-MM-dd-HH-mm-SS"},model:{value:t.valueTime,callback:function(e){t.valueTime=e},expression:"valueTime"}})],1),e("div",[e("el-button",{staticStyle:{"margin-top":"10px","margin-left":"20px"},attrs:{type:"primary"},on:{click:t.publish}},[t._v("发布作业")])],1)],1),e("div",{staticClass:"block"})],1),e("el-tab-pane",{attrs:{label:"提交情况"}},[e("el-button",{on:{click:function(e){t.drawer_2=!0}}},[t._v("开启互评")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.stus,"max-height":"8 50","default-sort":{prop:"evaScore",order:"descending"}}},[e("el-table-column",{attrs:{fixed:"",prop:"uHead",label:"",width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{staticClass:"head_pic",attrs:{src:t.row.uHead,width:"40",height:"40"}})]}}])}),e("el-table-column",{attrs:{fixed:"",prop:"uID",label:"学生",width:"150"}}),e("el-table-column",{attrs:{fixed:"",prop:"uName",label:"学生",width:"150"}}),e("el-table-column",{attrs:{fixed:"",prop:"isSubmit",label:"是否提交",width:"250"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.isSubmit?e("span",[t._v("已提交")]):e("span",[t._v("未提交")])]}}])}),e("el-table-column",{attrs:{fixed:"",prop:"evaScore",label:"分数",width:"250"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.startRow(a.row)}}},[t._v(" 批改 ")]),e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.startRow_2(a.row)}}},[t._v(" 互评列表 ")])]}}])})],1)],1),e("el-dialog",{attrs:{title:"互评详细",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingDetail,expression:"loadingDetail"}],attrs:{data:t.gridData}},[e("el-table-column",{attrs:{property:"eID",label:"互评号",width:"150"}}),e("el-table-column",{attrs:{property:"name",label:"姓名",width:"200"}}),e("el-table-column",{attrs:{property:"score",label:"打分"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.startRow_3(a.row)}}},[t._v(" 查看详细 ")])]}}])})],1)],1),e("el-dialog",{attrs:{width:"1000",height:"3000",title:"详细",visible:t.dialogTableVisible_2},on:{"update:visible":function(e){t.dialogTableVisible_2=e}}},[e("div",{staticStyle:{"font-size":"20px"}},[t._v(" 分数: "+t._s(this.nscore)+" ")]),e("div",{staticStyle:{"font-size":"20px","margin-top":"10px"}},[t._v(" 点评内容: "+t._s(this.ncomment)+" ")]),e("div",{staticClass:"demo-image__preview",staticStyle:{"margin-top":"10px"}},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.nimg,"preview-src-list":[t.nimg]}})],1)]),e("el-drawer",{attrs:{title:"选择互评截止时间",visible:t.drawer_2,direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer_2=e}}},[e("div",{staticStyle:{"margin-left":"20px"}},[e("div",[e("span",{staticClass:"demonstration"},[t._v("设置截止时间")])]),e("el-date-picker",{staticStyle:{"margin-top":"10px"},attrs:{type:"datetime",placeholder:"选择日期时间","default-time":"00:00:00","value-format":"yyyy-MM-dd-HH-mm-SS"},model:{value:t.valueTime2,callback:function(e){t.valueTime2=e},expression:"valueTime2"}})],1),e("div",[e("el-button",{staticStyle:{"margin-top":"10px","margin-right":"20px",float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.startEvaluation()}}},[t._v("开始互评")])],1)])],1)],1)],1)],1)},It=[];const St=_.ip;var $t={data(){return{drawer:!1,drawer_2:!1,direction:"rtl",hwName:"",hwContent:"",isPreview:!1,html:"",valueTime:"",valueTime2:"",upload:!1,dialogTableVisible:!1,dialogTableVisible_2:!1,loadingDetail:!1,classes:[],options:[],stus:[],name:"",nscore:0,ncomment:"",nimg:"",markdownOption:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,help:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,preview:!0},score:0}},created(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(St+"getSavedHomework",t).then((t=>{1==t.data.code?"success"==t.data.msg?(null!=t.data.data.name&&(this.hwName=t.data.data.name),null!=t.data.data.content&&(this.hwContent=t.data.data.content)):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")})),g.Z.get(St+"getClasses").then((t=>{1==t.data.code?"success"==t.data.msg?this.options=t.data.data:this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}));var e=new URLSearchParams;e.append("hwID",this.$route.params.hwID),g.Z.post(St+"listStudentHomeworks",e).then((t=>{1==t.data.code?"success"==t.data.msg?this.stus=t.data.data:this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")})),g.Z.post(St+"header").then((t=>{this.header_url=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(St+"info").then((t=>{this.name=t.data.data.name})).catch((function(t){console.log(t)}))},methods:{caculate(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(St+"calculateScore",t).then((t=>{console.log(t.data.data);var e=new URLSearchParams;e.append("hwID",this.$route.params.hwID),g.Z.post(St+"listStudentHomeworks",e).then((t=>{1==t.data.code?"success"==t.data.msg?this.stus=t.data.data:this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))})).catch((t=>{alert(t),alert("请求失败")}))},startEvaluation(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),t.append("ddl",this.valueTime2),g.Z.post(St+"startEvaluation",t).then((t=>{console.log(t.data.data),this.$message({message:"开启互评成功",type:"success"}),this.drawer_2=!1})).catch((t=>{alert(t),alert("请求失败")}))},startRow(t){let e=this.$router.resolve({path:`/hw/evaluate/${this.$route.params.hwID}/${t.uID}`});window.open(e.href,"_blank")},startRow_2(t){this.dialogTableVisible=!0,this.loadingDetail=!0;var e=new URLSearchParams;e.append("hwID",this.$route.params.hwID),e.append("sID",t.uID),g.Z.post(St+"getEvaluatedMember",e).then((t=>{this.loadingDetail=!1,this.gridData=t.data.data})).catch((t=>{alert(t),alert("请求失败")}))},startRow_3(t){this.dialogTableVisible_2=!0;var e=new URLSearchParams;e.append("eID",t.eID),g.Z.post(St+"getEvaluationResult",e).then((t=>{this.nscore=t.data.data.score,this.ncomment=t.data.data.comment,this.nimg=t.data.data.image})).catch((t=>{alert(t),alert("请求失败")}))},$imgAdd(t,e){this.upload=!0;let a=this.$refs.md;var s=new FormData;s.append("file",e),console.log(e),(0,g.Z)({url:St+"uploadFile",method:"post",data:s}).then((e=>{this.$message({message:"上传图片成功",type:"success"}),this.upload=!1,a.$img2Url(t,e.data.data)}))},changeFile(){const t=document.getElementById("open");if(null!=t){this.upload=!0,console.log(t.files[0]);var e=new FormData;e.append("file",t.files[0]),(0,g.Z)({url:St+"uploadFile",method:"post",data:e}).then((e=>{this.$message({message:"上传附件成功",type:"success"}),null==this.hwContent?this.hwContent="["+t.files[0].name+"]("+e.data.data+")":this.hwContent=this.hwContent+"["+t.files[0].name+"]("+e.data.data+")",this.upload=!1}))}},$fileAdd(){document.getElementById("open").click()},save(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),t.append("name",this.hwName),t.append("content",this.hwContent),g.Z.post(St+"saveHomework",t).then((t=>{1==t.data.code?"success"==t.data.msg?this.$message({message:"保存成功",type:"success"}):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))},publish(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),t.append("classes",[this.$route.params.classID]),t.append("name",this.hwName),t.append("content",this.hwContent),t.append("ddl",this.valueTime),t.append("score",this.score),g.Z.post(St+"publishHomework",t).then((t=>{1==t.data.code?"success"==t.data.msg?(this.$message({message:"发布成功",type:"success"}),this.drawer=!1):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))}}},Ct=$t,Zt=(0,d.Z)(Ct,Dt,It,!1,null,null,null),Ut=Zt.exports,Nt=function(){var t=this,e=t._self._c;return e("div",[e("el-header",[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[e("el-menu-item",{directives:[{name:"loading",rawName:"v-loading",value:""===this.name,expression:"this.name===''"}],staticStyle:{float:"right","font-weight":"bold"}},[t._v("你好，"+t._s(this.name)+"，欢迎使用CCN互评系统👋")])],1)],1),e("el-container",[e("el-aside",{attrs:{width:"200px"}}),e("el-main",[e("div",{staticClass:"demo-input-suffix",staticStyle:{"font-size":"30px"}},[t._v(" 作业名："+t._s(this.hwName)+" ")]),e("el-divider"),e("div",[e("div",{domProps:{innerHTML:t._s(t.compiledMarkdown)}})]),e("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"filename",id:"open"},on:{change:t.changeFile}}),e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.upload,expression:"upload"}]},[e("div",[t._v(" 编写作业： "),e("mavon-editor",{ref:"md",attrs:{toolbars:t.markdownOption},on:{imgAdd:t.$imgAdd},model:{value:t.hwWrite,callback:function(e){t.hwWrite=e},expression:"hwWrite"}},[e("template",{slot:"left-toolbar-after"},[e("button",{staticClass:"op-icon el-icon-paperclip",attrs:{type:"button","aria-hidden":"true",title:"上传附件"},on:{click:t.$fileAdd}})])],2)],1)]),e("div",{staticStyle:{float:"right","margin-right":"100px"}},[e("el-button",{on:{click:t.save}},[t._v("暂存")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1),e("div",{staticClass:"block"})],1)],1)],1)},Rt=[],Pt=a(637);a(5225);const Tt=_.ip;var Lt={data(){return{hwName:"",hwContent:"loading...",hwWrite:" ",markdown:"# loading...",html:"",name:"",upload:!1,markdownOption:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,help:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,preview:!0}}},created(){g.Z.post(Tt+"header").then((t=>{this.header_url=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(Tt+"info").then((t=>{this.name=t.data.data.name})).catch((function(t){console.log(t)}));var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(Tt+"getSavedHomework-stu",t).then((t=>{1==t.data.code?"success"==t.data.msg?(null!=t.data.data.name&&(this.hwName=t.data.data.name),null!=t.data.data.homework&&(this.hwContent=t.data.data.homework),null!=t.data.data.content&&(this.hwWrite=t.data.data.content)):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))},methods:{$imgAdd(t,e){this.upload=!0;let a=this.$refs.md;var s=new FormData;s.append("file",e),console.log(e),(0,g.Z)({url:Tt+"uploadFile",method:"post",data:s}).then((e=>{this.$message({message:"上传图片成功",type:"success"}),a.$img2Url(t,e.data.data),this.upload=!1}))},changeFile(){const t=document.getElementById("open");if(null!=t){this.upload=!0,console.log(t.files[0]);var e=new FormData;e.append("file",t.files[0]),(0,g.Z)({url:Tt+"uploadFile",method:"post",data:e}).then((e=>{this.$message({message:"上传附件成功",type:"success"}),null==this.hwWrite?this.hwWrite="["+t.files[0].name+"]("+e.data.data+")":this.hwWrite=this.hwWrite+"["+t.files[0].name+"]("+e.data.data+")",this.upload=!1}))}},$fileAdd(){document.getElementById("open").click()},save(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),t.append("content",this.hwWrite),g.Z.post(Tt+"saveHomework-stu",t).then((t=>{1==t.data.code?"success"==t.data.msg?this.$message({message:"保存成功",type:"success"}):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))},submit(){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),t.append("content",this.hwWrite),g.Z.post(Tt+"submitHomework",t).then((t=>{1==t.data.code?"success"==t.data.msg?this.$message({message:"提交成功",type:"success"}):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))}},computed:{compiledMarkdown(){var t=new it.TU.Renderer;return it.TU.setOptions({renderer:t,highlight:function(t){return Pt.Z.highlightAuto(t).value},pedantic:!1,gfm:!0,tables:!0,breaks:!0,sanitize:!0,smartLists:!0,smartypants:!0,xhtml:!0}),it.TU.parse(this.hwContent)}}},Mt=Lt,Ht=(0,d.Z)(Mt,Nt,Rt,!1,null,null,null),zt=Ht.exports,At=function(){var t=this,e=t._self._c;return e("div",[e("el-header",[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[e("el-menu-item",{directives:[{name:"loading",rawName:"v-loading",value:""===this.name,expression:"this.name===''"}],staticStyle:{float:"right","font-weight":"bold"}},[t._v("你好，"+t._s(this.name)+"，欢迎使用CCN互评系统👋")])],1)],1),e("el-container",[e("el-aside",{attrs:{width:"200px"}}),e("el-main",[e("router-view")],1)],1),e("div",{staticClass:"demo-input-suffix",staticStyle:{"font-size":"30px"}},[t._v(" 作业名："+t._s(this.hwName)+" ")]),e("el-divider"),e("div",[e("div",{domProps:{innerHTML:t._s(t.compiledMarkdown)}})]),e("el-divider"),e("div",{staticStyle:{"font-size":"30px"}},[t._v(" 编写作业： ")]),e("div",[e("div",{domProps:{innerHTML:t._s(t.compiledMarkdown_2)}})]),e("div"),e("div",{staticClass:"block"})],1)},Ot=[];const jt=_.ip;var Wt={data(){return{hwName:"",hwContent:"loading...",hwWrite:" ",markdown:"# loading...",html:"",markdownOption:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,help:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,preview:!0},name:""}},created(){g.Z.post(jt+"header").then((t=>{this.header_url=t.data.data})).catch((function(t){console.log(t)})),g.Z.post(jt+"info").then((t=>{this.name=t.data.data.name})).catch((function(t){console.log(t)}));var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(jt+"getSavedHomework-stu",t).then((t=>{1==t.data.code?"success"==t.data.msg?(this.hwName=t.data.data.name,this.hwContent=t.data.data.homework,this.hwWrite=t.data.data.content):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))},computed:{compiledMarkdown(){return it.TU.parse(this.hwContent)},compiledMarkdown_2(){return it.TU.parse(this.hwWrite)}}},Ft=Wt,Et=(0,d.Z)(Ft,At,Ot,!1,null,null,null),Vt=Et.exports,Bt=function(){var t=this,e=t._self._c;return e("div",[e("div",[0==t.viewInfo.isDraw?e("el-button",{on:{click:function(e){t.viewInfo.isDraw=!0,t.$refs.md.blur(),t.$refs.md2.focus(),t.initCanvasSize()}}},[t._v("画笔:关")]):t._e(),1==t.viewInfo.isDraw?e("el-button",{on:{click:function(e){t.viewInfo.isDraw=!1}}},[t._v("画笔:开")]):t._e(),null==t.$route.params.uID?e("el-button",{staticStyle:{float:"right"},on:{click:function(e){return t.nextHw()}}},[t._v("下一份")]):t._e(),e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.upload,expression:"upload"}],staticStyle:{float:"right"},attrs:{disabled:""==t.inputScore,type:"primary"},on:{click:function(e){return t.commit()}}},[t._v("提交评分")]),e("el-input",{staticStyle:{width:"100px",float:"right"},attrs:{placeholder:"分数"},model:{value:t.inputScore,callback:function(e){t.inputScore=e},expression:"inputScore"}})],1),1==t.viewInfo.isDraw?e("div",[e("span",{staticClass:"demonstration"},[t._v("粗细")]),e("el-slider",{staticStyle:{width:"100px"},attrs:{min:t.min,max:t.max},model:{value:t.viewInfo.cx,callback:function(e){t.$set(t.viewInfo,"cx",e)},expression:"viewInfo.cx"}})],1):t._e(),e("div",{ref:"cap"},[e("div",{ref:"md",staticStyle:{position:"absolute"}},[e("div",{domProps:{innerHTML:t._s(t.html)}})]),e("div",{ref:"md2",staticStyle:{position:"absolute",top:"y",left:"x"}},[e("canvas",{ref:"canvas",staticClass:"main-canvas",staticStyle:{position:"absolute",top:"0px",left:"0px"},attrs:{id:"main-canvas"}})])]),e("div",[e("el-input",{staticStyle:{position:"fixed",bottom:"0"},attrs:{placeholder:"请输入批注内容"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1)])},Xt=[],qt=(a(2801),a(1439),a(7585),a(5315),a(1120)),Yt=a.n(qt);const Gt=_.ip;var Kt={data(){return{eID:0,input:"",inputScore:"",min:1,max:8,homework:{data:"# 111"},evaluation:{points:[]},position:{x:1,y:1,y2:1},viewInfo:{isDraw:!1,isDrawing:!1,cx:4},canvas:null,ctx:null,image:"",upload:!1}},mounted(){this.homework.data="## loading...",this.x=this.$refs.md.getBoundingClientRect().x,this.y=this.$refs.md.getBoundingClientRect().y,this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this.handleMouseDown),this.canvas.addEventListener("mouseup",this.handleMouseUp),this.canvas.addEventListener("mousemove",this.handleMouseMove),this.initCanvasSize()},created(){if(null==this.$route.params.uID){var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(Gt+"getEvaluation",t).then((t=>{1==t.data.code&&"success"==t.data.msg?null!=t.data.data.content&&(this.eID=t.data.data.eID,this.homework.data=t.data.data.content):this.$message.error(t.data.msg)})).catch((t=>{alert(t),alert("请求失败")}))}else{var e=new URLSearchParams;e.append("hwID",this.$route.params.hwID),e.append("sID",this.$route.params.uID),g.Z.post(Gt+"getStudentHomework",e).then((t=>{1==t.data.code?"success"==t.data.msg?null!=t.data.data.content&&(this.homework.data=t.data.data.content):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))}},computed:{html(){var t=new it.TU.Renderer;return it.TU.setOptions({renderer:t,highlight:function(t){return Pt.Z.highlightAuto(t).value},pedantic:!1,gfm:!0,tables:!0,breaks:!0,sanitize:!0,smartLists:!0,smartypants:!0,xhtml:!0}),it.TU.parse(this.homework.data)}},methods:{changeToBlob(t){var e=t.split(","),a=e[0].match(/:(.*?);/)[1],s=atob(e[1]),i=s.length,n=new Uint8Array(i);while(i--)n[i]=s.charCodeAt(i);return new Blob([n],{type:a})},base64ImgtoFile(t,e="file"){let a=t.split(","),s=a[0].match(/:(.*?);/)[1],i=s.split("/")[1],n=atob(a[1]),o=n.length,l=new Uint8Array(o);while(o--)l[o]=n.charCodeAt(o);return new File([l],`${e}.${i}`,{type:s})},capture(){Yt()(this.$refs.cap,this.canvas,{height:this.canvas.scrollHeight,width:this.canvas.scrollWidth}).then((t=>{let e=t.toDataURL("image/png"),a=this.base64ImgtoFile(e);var s=new FormData;s.append("file",a),console.log(a),(0,g.Z)({url:Gt+"uploadFile",method:"post",data:s}).then((t=>{this.img=t.data.data;var e=new URLSearchParams;e.append("hwID",this.$route.params.hwID),e.append("eID",this.eID),e.append("score",this.inputScore),e.append("comment",this.input),e.append("image",this.img),g.Z.post(Gt+"evaluate",e).then((t=>{1==t.data.code?"success"==t.data.msg?(this.$message({message:"提交成功",type:"success"}),this.upload=!1,this.input=""):this.$message.error(t.data.msg):alert("网络错误")})).catch((t=>{alert(t),alert("请求失败")}))}))}))},initCanvasSize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.y2=this.$refs.md.getBoundingClientRect().y+this.$refs.md.clientHeight},draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=1;t<this.evaluation.points.length;t++){const e=this.evaluation.points[t-1],a=this.evaluation.points[t];this.ctx.strokeStyle=e.color,this.ctx.lineWidth=e.cx,-1e4!==e.x&&-1e4!==a.x&&(this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(a.x,a.y),this.ctx.stroke())}},handleMouseDown(t){const{offsetX:e,offsetY:a}=t;this.initCanvasSize(),this.viewInfo.isDraw&&(this.viewInfo.isDrawing=!0),this.draw()},handleMouseMove(t){const{offsetX:e,offsetY:a}=t;this.viewInfo.isDrawing&&(this.evaluation.points.push({x:e,y:a,color:"red",cx:this.viewInfo.cx}),this.draw())},handleMouseUp(){this.viewInfo.isDrawing=!1,this.evaluation.points.push({x:-1e4,y:-1e4})},nextHw(){this.evaluation.points=[],this.draw();var t=new URLSearchParams;t.append("hwID",this.$route.params.hwID),g.Z.post(Gt+"getEvaluation",t).then((t=>{1==t.data.code&&"success"==t.data.msg?(this.eID=t.data.data.eID,null!=t.data.data.content&&(this.homework.data=t.data.data.content)):this.$message.error(t.data.msg)})).catch((t=>{alert(t),alert("请求失败")}))},commit(){this.upload=!0,this.capture()}}},Jt=Kt,Qt=(0,d.Z)(Jt,Bt,Xt,!1,null,null,null),te=Qt.exports;s["default"].use(u.Z);const ee=new u.Z({mode:"hash",routes:[{path:"/",name:"login",component:$},{path:"/login",name:"login",component:$},{path:"/register",name:"register",component:T},{path:"/home",name:"index",component:j,children:[{path:"/msg",name:"msg",component:q},{path:"/chg",name:"chg",component:et},{path:"/self",name:"self",component:dt},{path:"/class",name:"cls",component:vt},{path:"/class/:classID",name:"clsInfo",component:kt}]},{path:"/hw/publish/:classID",name:"hwPub",component:Ut},{path:"/hw/publish/:hwID/:classID",name:"hwPub",component:Ut},{path:"/hw/write/:hwID",name:"hwWrt",component:zt},{path:"/hw/watch/:hwID",name:"hwWtc",component:Vt},{path:"/hw/evaluate/:hwID",name:"evaluate",component:te},{path:"/hw/evaluate/:hwID/:uID/",name:"evaluate",component:te}]}),ae=u.Z.prototype.push;u.Z.prototype.push=function(t){return ae.call(this,t).catch((t=>t))};var se=ee,ie=a(4720),ne=a.n(ie),oe=a(5379),le=a.n(oe),re=a(3067),de=a.n(re);s["default"].use(de()),s["default"].use(Yt()),s["default"].use(ne()),s["default"].use(u.Z),s["default"].use(le()),g.Z.interceptors.request.use((function(t){return localStorage.getItem("CCNtoken")&&(t.headers["token"]=localStorage.getItem("CCNtoken")),t}),(function(t){return se.push("/login"),Promise.reject(t)})),new s["default"]({render:t=>t(h),router:se,axios:g.Z}).$mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,s,i,n){if(!s){var o=1/0;for(c=0;c<t.length;c++){s=t[c][0],i=t[c][1],n=t[c][2];for(var l=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(a.O).every((function(t){return a.O[t](s[r])}))?s.splice(r--,1):(l=!1,n<o&&(o=n));if(l){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[s,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,n,o=s[0],l=s[1],r=s[2],d=0;if(o.some((function(e){return 0!==t[e]}))){for(i in l)a.o(l,i)&&(a.m[i]=l[i]);if(r)var c=r(a)}for(e&&e(s);d<o.length;d++)n=o[d],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(c)},s=self["webpackChunkgitccn"]=self["webpackChunkgitccn"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(725)}));s=a.O(s)})();
//# sourceMappingURL=app.4c04a576.js.map